generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id             Int               @id @default(autoincrement())
  email          String            @unique
  createdAt      DateTime          @default(now())
  city           String
  password       String
  points         Int               @default(0)
  postcode       String
  role           Role              @default(USER)
  state          String
  street         String
  updatedAt      DateTime          @updatedAt
  username       String
  fullName       String
  appointments   Appointment[]
  managedCentres RecyclingCentre[] @relation("CentreAdmins")

  @@index([email])
  @@index([username])
}

model Appointment {
  id        Int               @id @default(autoincrement())
  date      DateTime
  status    AppointmentStatus @default(PENDING)
  createdAt DateTime          @default(now())
  userId    Int
  centreId  Int
  centre    RecyclingCentre   @relation(fields: [centreId], references: [id])
  user      User              @relation(fields: [userId], references: [id])

  @@index([userId])
  @@index([centreId])
}

model RecyclingCentre {
  id           Int           @id @default(autoincrement())
  name         String
  street       String
  city         String
  state        String
  postcode     String
  adminId      Int
  appointments Appointment[]
  admin        User          @relation("CentreAdmins", fields: [adminId], references: [id])
}

enum Role {
  USER
  ADMIN
  SUPERADMIN
}

enum AppointmentStatus {
  PENDING
  COMPLETED
  CANCELLED
}
